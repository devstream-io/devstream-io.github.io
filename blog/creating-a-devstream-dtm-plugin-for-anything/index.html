<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.96.0"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Creating a DevStream (dtm) Plugin for Anything | DevStream</title><meta name=description content="A Tutorial of DevStream Plugin Development"><meta property="og:title" content="Creating a DevStream (dtm) Plugin for Anything"><meta property="og:description" content="A Tutorial of DevStream Plugin Development"><meta property="og:type" content="article"><meta property="og:url" content="https://www.devstream.io/blog/creating-a-devstream-dtm-plugin-for-anything/"><meta property="og:image" content="https://www.devstream.io/blog/creating-a-devstream-dtm-plugin-for-anything/featured-background.jpg"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-03-29T00:00:00+00:00"><meta property="article:modified_time" content="2022-04-02T16:44:16+08:00"><meta property="og:site_name" content="DevStream"><meta itemprop=name content="Creating a DevStream (dtm) Plugin for Anything"><meta itemprop=description content="A Tutorial of DevStream Plugin Development"><meta itemprop=datePublished content="2022-03-29T00:00:00+00:00"><meta itemprop=dateModified content="2022-04-02T16:44:16+08:00"><meta itemprop=wordCount content="2361"><meta itemprop=image content="https://www.devstream.io/blog/creating-a-devstream-dtm-plugin-for-anything/featured-background.jpg"><meta itemprop=keywords content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.devstream.io/blog/creating-a-devstream-dtm-plugin-for-anything/featured-background.jpg"><meta name=twitter:title content="Creating a DevStream (dtm) Plugin for Anything"><meta name=twitter:description content="A Tutorial of DevStream Plugin Development"><link rel=preload href=/scss/main.min.209ee91954d0f2f182770e6c71011a5580360636bcf2a9bcf7f1c3da478784ff.css as=style><link href=/scss/main.min.209ee91954d0f2f182770e6c71011a5580360636bcf2a9bcf7f1c3da478784ff.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-00000000-0","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="td-page td-blog"><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class=font-weight-bold>DevStream</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/blog/><span class=active>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/devstream-io/devstream target=_blank><span>GitHub</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://docs.devstream.io/en/latest/ target=_blank><span>Docs</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://medium.com/devstream target=_blank><span>Medium</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://dev.to/devstream target=_blank><span>Dev.to</span></a></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/blog/creating-a-devstream-dtm-plugin-for-anything/>中文</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><div class="nav-item dropdown d-block d-lg-none"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/blog/creating-a-devstream-dtm-plugin-for-anything/>中文</a></div></div><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-blog-li><a href=/blog/ title="DevStream Blog" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-blog><span>Blog</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-bloghow-to-li><a href=/blog/how-to/ title="How-to About DevStream" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-bloghow-to><span>How-To</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-blogcreating-a-devstream-dtm-plugin-for-anything-li><a href=/blog/creating-a-devstream-dtm-plugin-for-anything/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-blogcreating-a-devstream-dtm-plugin-for-anything><span class=td-sidebar-nav-active-item>Creating a DevStream (dtm) Plugin for Anything</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bloghello-world-li><a href=/blog/hello-world/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-bloghello-world><span>Hello, World</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogcommunity-li><a href=/blog/community/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-blogcommunity><span>Community</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-blogreleases-li><a href=/blog/releases/ title="New Releases" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-blogreleases><span>Releases</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogv031-release-note-li><a href=/blog/v0.3.1-release-note/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-blogv031-release-note><span>v0.3.1 Release Note</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-bloggeneral-li><a href=/blog/general/ title="General Articles" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-bloggeneral><span>General</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-blogdagger-the-cicd-tool-not-the-knife-in-depth-everything-you-need-to-know-as-of-apr-2022-li><a href=/blog/dagger-the-ci/cd-tool-not-the-knife-in-depth-everything-you-need-to-know-as-of-apr-2022/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-blogdagger-the-cicd-tool-not-the-knife-in-depth-everything-you-need-to-know-as-of-apr-2022><span>Dagger (the CI/CD Tool, not the Knife) In-Depth: Everything You Need to Know (as of Apr 2022)</span></a></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/devstream-io/website/tree/main/content/en/blog/how-to/creating-a-plugin/index.md class=td-page-meta--view target=_blank rel=noopener><i class="fa fa-file-alt fa-fw"></i> View page source</a>
<a href=https://github.com/devstream-io/website/edit/main/content/en/blog/how-to/creating-a-plugin/index.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/devstream-io/website/new/main/content/en/blog/how-to/creating-a-plugin/index.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/devstream-io/website/issues/new?title=Creating%20a%20DevStream%20%28dtm%29%20Plugin%20for%20Anything" class=td-page-meta--issue target=_blank rel=noopener><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/devstream-io/devstream/issues/new class=td-page-meta--project-issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create project issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#what-is-devstream>What is DevStream</a></li><li><a href=#existing-plugins>Existing Plugins</a></li><li><a href=#why-would-i-want-to-create-a-devstream-plugin>Why Would I Want to Create a DevStream Plugin</a></li><li><a href=#design-a-local-file-plugin>Design: A &ldquo;Local File&rdquo; Plugin</a></li><li><a href=#scaffolding-automagically>Scaffolding Automagically</a><ul><li><a href=#cmd>cmd/</a></li><li><a href=#docs>docs/</a></li><li><a href=#internalpkg>internal/pkg/</a></li></ul></li><li><a href=#core-concepts>Core Concepts</a><ul><li><a href=#configstateresource>Config/State/Resource</a></li><li><a href=#interfaces>Interfaces</a></li></ul></li><li><a href=#coding>Coding</a><ul><li><a href=#input-optionsvalidation>Input Options/Validation</a></li><li><a href=#create>Create()</a></li><li><a href=#read>Read()</a></li><li><a href=#update>Update()</a></li><li><a href=#delete>Delete()</a></li></ul></li><li><a href=#build>Build</a></li><li><a href=#test>Test</a></li><li><a href=#summary>Summary</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5 pr-md-4" role=main><a class="btn btn-lg -bg-orange td-rss-button d-none d-lg-block" href=https://www.devstream.io/blog/how-to/index.xml target=_blank>RSS <i class="fa fa-rss ml-2"></i></a><div class=td-content><h1>Creating a DevStream (dtm) Plugin for Anything</h1><div class=lead>A Tutorial of DevStream Plugin Development</div><div class="td-byline mb-4">By <b>Tiexin Guo (<a href=https://github.com/IronCore864>@IronCore864</a>)</b> |
<time datetime=2022-03-29 class=text-muted>Tuesday, March 29, 2022</time></div><header class=article-meta></header><p>Yes, the title of this post isn&rsquo;t bluffing: you can actually create a plugin for just about anything that takes your fancy.</p><blockquote><p>In my previous article, I walked you guys through DevStream&rsquo;s codebase.</p><p>If you haven&rsquo;t read it yet, here&rsquo;s a quick link for you:</p><p><a href=../hello-world>Hello, world!</a>.</p></blockquote><p>In this blog, we will walk you through the steps of creating a DevStream plugin from scratch with an example.</p><hr><div class="card rounded p-2 td-post-card mb-4 mt-4" style=max-width:1210px><img class=card-img-top src=/blog/creating-a-devstream-dtm-plugin-for-anything/featured-background_hubced0a870f76eab482d622a0dd2f964e_408122_1200x800_fill_q75_catmullrom_smart1.jpg width=1200 height=800><div class="card-body px-0 pt-2 pb-0"><p class=card-text>A cat outside a lake side Starbucks, Chengdu, China.
<small class=text-muted><br>Photo: Tiexin Guo / CC-BY-CA</small></p></div></div><hr><blockquote><p>English version: <a href=../creating-a-devstream-dtm-plugin-for-anything/>《Creating a DevStream (dtm) Plugin for Anything》</a>Author: @Tiexin Guo(郭铁心)</p><p>中文版：<a href=../../zh/blog/creating-a-devstream-dtm-plugin-for-anything/>《给 DevStream (dtm) 开发一个插件，整合一切你想要的功能》</a>作者：@胡涛(Daniel Hu)</p></blockquote><hr><h2 id=what-is-devstream>What is DevStream</h2><p>DevStream is an amazing tool that lets you install, update, manage, and integrate your DevOps tools quickly and flexibly.</p><p>Not to brag, but with DevStream, you can have your own DevOps toolchain that is specifically tailored to your need up and running in 5 minutes.</p><p>Don&rsquo;t believe it? Check out our <a href=https://docs.devstream.io/en/latest/>docs</a> and follow the quickstart guide!</p><h2 id=existing-plugins>Existing Plugins</h2><p>At the moment of publishing this article, we already support the following tools:</p><ul><li>Trello (including integration with GitHub)</li><li>Jira (integration with GitHub)</li><li>GitHub Repository bootstrapping (for Go)</li><li>GitHub Actions (for Go, Python, and Nodejs)</li><li>GitLab CI (for Go)</li><li>Jenkins (installation)</li><li>ArgoCD</li><li>ArgoCD Application (the deployment of your apps)</li><li>Prometheus + Grafana</li><li>DevLake</li><li>OpenLDAP</li></ul><p>We aim to have 50 plugins at the end of 2022!</p><p>Check out our <a href=https://github.com/devstream-io/devstream>README</a> for the latest status.</p><h2 id=why-would-i-want-to-create-a-devstream-plugin>Why Would I Want to Create a DevStream Plugin</h2><p>Wait. YOU ALREADY HAVE TONS OF PLUGINS! Why on earth would I want to create yet another one?</p><p>I agree with you.</p><p>Can I get a show of hands, who here has made a DevStream plugin before?</p><p>Very few, if any, I guess.</p><p>However (I know it&rsquo;s just a fancy &ldquo;but&rdquo;), there are, in fact, things that you want to build a plugin for:</p><ul><li>Maybe you are building a nice and shiny DevOps tool, and you want to be able to set it up quickly without any hassle. You would have to write some automation scripts for it anyway, right? DevStream got you covered.</li><li>Maybe you even need to integrate your tool with other tools to get the most out of it and you really don&rsquo;t want to reinvent a lot of wheels just to manage those boring integrations. Again, DevStream got you covered.</li><li>Maybe you have both internal tools and open-source tools whose installation and integration need to be automated. The open-source tools are fine, but how to manage those internal ones and integrate them? DevStream got you covered.</li></ul><p>Or, maybe you just want to learn Go&rsquo;s plugin, become a contributor, join our community and earn your certification (maybe a small present, too, who knows.) No problem.</p><p>No matter what your intention is and what thing you want to achieve, DevStream got you covered.</p><p>So hang tight, let&rsquo;s get started.</p><h2 id=design-a-local-file-plugin>Design: A &ldquo;Local File&rdquo; Plugin</h2><p>In this example, let&rsquo;s build something dum but simple, just to show you the process of creating a plugin.</p><p>We are creating a &ldquo;local file&rdquo; plugin. You specify the name and the content, and the plugin will create a local file for you. Let&rsquo;s decide how we are going to use this plugin:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>tools</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-file</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>plugin</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>localfile</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>filename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>foo.txt</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>content</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;hello, world&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Basically:</p><ul><li>the name of the plugin: <code>localfile</code></li><li>options of the plugin:<ul><li>filename</li><li>content</li></ul></li></ul><p>The plugin will create a file with desired content according to this piece of config.</p><h2 id=scaffolding-automagically>Scaffolding Automagically</h2><p>First, let&rsquo;s clone the DevStream repo and generate some scaffolding code:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git clone git@github.com:devstream-io/devstream.git
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> stream
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># builds dtm locally to make sure it&#39;s using the same dependencies as your new plugin</span>
</span></span><span style=display:flex><span>make build-core
</span></span><span style=display:flex><span>./dtm develop create-plugin --name<span style=color:#ce5c00;font-weight:700>=</span>localfile
</span></span></code></pre></div><p>There will be some useful output to guide you through the whole process.</p><p>Now, if we do a <code>git status</code>, we can see some new stuff are already created automagically:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ git status
</span></span><span style=display:flex><span>On branch main
</span></span><span style=display:flex><span>Your branch is up to date with <span style=color:#4e9a06>&#39;origin/main&#39;</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Untracked files:
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>(</span>use <span style=color:#4e9a06>&#34;git add &lt;file&gt;...&#34;</span> to include in what will be committed<span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    cmd/plugin/localfile/
</span></span><span style=display:flex><span>    docs/plugins/localfile.md
</span></span><span style=display:flex><span>    internal/pkg/plugin/localfile/
</span></span></code></pre></div><p>Let&rsquo;s have a quick recap of the directory structure:</p><h3 id=cmd>cmd/</h3><p><code>cmd/plugin/localfile/main.go</code> is the main entrance of your plugin. But here you don&rsquo;t need to do anything; nothing.</p><p><code>dtm</code> has already generated the code for you, including the interfaces that you must implement.</p><h3 id=docs>docs/</h3><p><code>docs/plugins/localfile.md</code> is the automatically generated documentation.</p><p>Yep, I know <code>dtm</code> is automagic, but it can&rsquo;t read your mind. I&rsquo;m afraid that you will have to write your own doc.</p><p>But hey, at least here you get a reminder that you need to create a doc :)</p><h3 id=internalpkg>internal/pkg/</h3><p><code>internal/pkg/plugin/localfile</code> has your plugin&rsquo;s main logic.</p><p>Here, we need to:</p><ul><li>define your input parameters (options);</li><li>implement the validation of the input parameters;</li><li>implement four mandatory interfaces.</li></ul><h2 id=core-concepts>Core Concepts</h2><h3 id=configstateresource>Config/State/Resource</h3><p>Before explaining interfaces and implementing them, let&rsquo;s have a look at how DevStream actually works:</p><ul><li><em>Config</em> is a list of tools, each of which has a name, plugin, options, etc.</li><li><em>State</em> is a map containing each tool&rsquo;s name, plugin, options, etc. It&rsquo;s used to store the result of <code>dtm</code>&rsquo;s last action.</li><li><em>Resource</em> is the tool that the plugin created. The <code>Read</code> interface returns a description of that resource, which should be the same as the <em>State</em> if nothing has been changed after <code>dtm</code>&rsquo;s last action.</li></ul><p>DevStream decides what to do based on your <em>Config</em>, the <em>State</em>, and the <em>Resource</em>&rsquo;s status. See the flowchart below:</p><p><img src=/img/config_state_resource.png alt></p><h3 id=interfaces>Interfaces</h3><p>A quick recap: each DevStream plugin must satisfy the following four interfaces:</p><ul><li><code>Create</code></li><li><code>Read</code></li><li><code>Update</code></li><li><code>Delete</code></li></ul><p>Return values:</p><ul><li><code>Create</code> and <code>Update</code> return two values <code>(map[string]interface{}, error)</code>. The first return value is considered as the <em>State</em>, which will be stored in DevStream&rsquo;s state file.</li><li><code>Read</code>&rsquo;s first return value is a description of the <em>Resource</em>, which should be the same as the <em>State</em> if nothing has changed.</li><li><code>Delete</code> returns <code>(true, nil)</code> if there is no error; otherwise it returns <code>(false, error)</code>.</li></ul><h2 id=coding>Coding</h2><h3 id=input-optionsvalidation>Input Options/Validation</h3><p>Now let&rsquo;s open <code>internal/pkg/plugin/localfile/options.go</code> and add options according to our design in the previous section.</p><p>The <code>internal/pkg/plugin/localfile/options.go</code> should look like:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>localfile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Options is the struct for configurations of the localfile plugin.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>Options</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Filename</span> <span style=color:#204a87;font-weight:700>string</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Content</span>  <span style=color:#204a87;font-weight:700>string</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Let&rsquo;s also implement the validation function of the input options.</p><p>Open <code>internal/pkg/plugin/localfile/validate.go</code> and change the logic to verify the options. It should look like this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>localfile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#4e9a06>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// validate validates the options provided by the core.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>validate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>options</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>Options</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>error</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>res</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87>make</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>options</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Filename</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#34;&#34;</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>res</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87>append</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>res</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Errorf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;filename does not exist&#34;</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>res</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=create>Create()</h3><p>We want to create the file based on the input options. So, let&rsquo;s do just that in the file <code>internal/pkg/plugin/localfile/create.go</code>.</p><p>OK, talk is cheap, show me the code:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>localfile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/mitchellh/mapstructure&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/devstream-io/devstream/pkg/util/log&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>Create</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>options</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{})</span> <span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{},</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>opts</span> <span style=color:#000>Options</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>mapstructure</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Decode</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>options</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>);</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>errs</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>validate</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>);</span> <span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>errs</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>_</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>e</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87;font-weight:700>range</span> <span style=color:#000>errs</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Errorf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Options error: %s.&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>e</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Errorf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;opts are illegal&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>writefile</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Filename</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Content</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>status</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}{</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;filename&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>opts</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Filename</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;content&#34;</span><span style=color:#000;font-weight:700>:</span>  <span style=color:#000>opts</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Content</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>If you compare the code above to the code generated by <code>dtm develop</code>, you will see that we basically did nothing here. We only filled some blanks which are marked by <code>dtm</code>&rsquo;s comment. The same is true for all the other interfaces.</p><p><em>A small tip: here, we can put the function <code>writefile</code> in <code>internal/pkg/plugin/localfile/localfile.go</code>, so that the code is better organized.</em></p><p>The <code>localfile.go</code> will look like this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>localfile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#4e9a06>&#34;os&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>writefile</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>filename</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>content</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>error</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>f</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>os</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Create</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>filename</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>defer</span> <span style=color:#000>f</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Close</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>_</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>f</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WriteString</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>content</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=read>Read()</h3><p>Let&rsquo;s also implement the <code>Read</code> interface.</p><p>The logic is simple: we want to try to see if the file exists or not, and if yes, what&rsquo;s the filename and content.</p><p><code>internal/pkg/plugin/localfile/read.go</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>localfile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;os&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;strings&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/mitchellh/mapstructure&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/devstream-io/devstream/pkg/util/log&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>Read</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>options</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{})</span> <span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{},</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>opts</span> <span style=color:#000>Options</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>mapstructure</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Decode</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>options</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>);</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>errs</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>validate</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>);</span> <span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>errs</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>_</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>e</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87;font-weight:700>range</span> <span style=color:#000>errs</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Errorf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Options error: %s.&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>e</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Errorf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;opts are illegal&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>content</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>os</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ReadFile</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Filename</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>strings</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Contains</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Error</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#4e9a06>&#34;no such file or directory&#34;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>status</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}{</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;filename&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>opts</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Filename</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;content&#34;</span><span style=color:#000;font-weight:700>:</span>  <span style=color:#204a87>string</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>content</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>On the return value:</p><ul><li>If the file doesn&rsquo;t exist, return nil, no error, because it means the resource hasn&rsquo;t been created yet (or deleted by somebody)</li><li>If the file exists, return the &ldquo;status&rdquo; of it and no error.</li><li>Otherwise, return nil and the error.</li></ul><h3 id=update>Update()</h3><p><code>Update</code> will be triggered if <code>Read</code> returns a different result than what&rsquo;s recorded in the <em>State</em>.</p><p>For the implementation, since we are updating a file, it&rsquo;s the same as <code>Create</code>, so we can actually reuse it here without duplicated code:</p><p><code>internal/pkg/plugin/localfile/update.go</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>localfile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>Update</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>options</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{})</span> <span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{},</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>Create</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>options</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=delete>Delete()</h3><p>Last but not least, let&rsquo;s implement the <code>Delete</code> interface.</p><p><code>internal/pkg/plugin/localfile/delete.go</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>localfile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;os&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/mitchellh/mapstructure&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;github.com/devstream-io/devstream/pkg/util/log&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>Delete</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>options</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{})</span> <span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>bool</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>opts</span> <span style=color:#000>Options</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>mapstructure</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Decode</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>options</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>);</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>errs</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>validate</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>);</span> <span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>errs</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>_</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>e</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87;font-weight:700>range</span> <span style=color:#000>errs</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Errorf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Options error: %s.&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>e</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Errorf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;opts are illegal&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>os</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Remove</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>opts</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Filename</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Just delete the file; nothing to look at here.</p><h2 id=build>Build</h2><p>Now that we finished coding, let&rsquo;s build our new plugin. Our Makefile now supports building a specific plugin only:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>make build-plugin.localfile
</span></span></code></pre></div><h2 id=test>Test</h2><p>First, let&rsquo;s create a config file <code>config-localfile-test.yaml</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>tools</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>my-file</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>plugin</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>localfile</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>options</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>filename</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>foo.txt</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>content</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;hello, world&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Now, let&rsquo;s <code>apply</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ./dtm -y apply -f config-localfile-test.yaml
</span></span><span style=display:flex><span>2022-03-29 11:25:17 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Apply started.
</span></span><span style=display:flex><span>2022-03-29 11:25:17 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Using dir &lt;.devstream&gt; to store plugins.
</span></span><span style=display:flex><span>2022-03-29 11:25:17 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Tool my-file <span style=color:#ce5c00;font-weight:700>(</span>localfile<span style=color:#ce5c00;font-weight:700>)</span> found in config but doesn<span style=color:#a40000>&#39;</span>t exist in the state, will be created.
</span></span><span style=display:flex><span>2022-03-29 11:25:17 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Start executing the plan.
</span></span><span style=display:flex><span>2022-03-29 11:25:17 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Changes count: 1.
</span></span><span style=display:flex><span>2022-03-29 11:25:17 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  -------------------- <span style=color:#ce5c00;font-weight:700>[</span>  Processing progress: 1/1.  <span style=color:#ce5c00;font-weight:700>]</span> --------------------
</span></span><span style=display:flex><span>2022-03-29 11:25:17 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Processing: my-file <span style=color:#ce5c00;font-weight:700>(</span>localfile<span style=color:#ce5c00;font-weight:700>)</span> -&gt; Create ...
</span></span><span style=display:flex><span>2022-03-29 11:25:17 ✔ <span style=color:#ce5c00;font-weight:700>[</span>SUCCESS<span style=color:#ce5c00;font-weight:700>]</span>  Plugin my-file<span style=color:#ce5c00;font-weight:700>(</span>localfile<span style=color:#ce5c00;font-weight:700>)</span> Create <span style=color:#204a87;font-weight:700>done</span>.
</span></span><span style=display:flex><span>2022-03-29 11:25:17 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  -------------------- <span style=color:#ce5c00;font-weight:700>[</span>  Processing <span style=color:#204a87;font-weight:700>done</span>.  <span style=color:#ce5c00;font-weight:700>]</span> --------------------
</span></span><span style=display:flex><span>2022-03-29 11:25:17 ✔ <span style=color:#ce5c00;font-weight:700>[</span>SUCCESS<span style=color:#ce5c00;font-weight:700>]</span>  All plugins applied successfully.
</span></span><span style=display:flex><span>2022-03-29 11:25:17 ✔ <span style=color:#ce5c00;font-weight:700>[</span>SUCCESS<span style=color:#ce5c00;font-weight:700>]</span>  Apply finished.
</span></span></code></pre></div><p>As we can see, the plugin has created our file successfully. To verify, you can open the &ldquo;foo.txt&rdquo; file to have a look.</p><p>If we <code>apply</code> again, nothing should happen, since the file is already created with the desired content:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ./dtm -y apply -f config-localfile-test.yaml
</span></span><span style=display:flex><span>2022-03-29 11:30:43 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Apply started.
</span></span><span style=display:flex><span>2022-03-29 11:30:43 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Using dir &lt;.devstream&gt; to store plugins.
</span></span><span style=display:flex><span>2022-03-29 11:30:45 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  No changes <span style=color:#204a87;font-weight:700>done</span> since last apply. There is nothing to <span style=color:#204a87;font-weight:700>do</span>.
</span></span><span style=display:flex><span>2022-03-29 11:30:45 ✔ <span style=color:#ce5c00;font-weight:700>[</span>SUCCESS<span style=color:#ce5c00;font-weight:700>]</span>  Apply finished.
</span></span></code></pre></div><p>But, what if somebody changed the content of &ldquo;foo.txt&rdquo;? Let&rsquo;s experiment:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ <span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;changed&#34;</span> &gt; foo.txt
</span></span><span style=display:flex><span>$ ./dtm -y apply -f config-localfile-test.yaml
</span></span><span style=display:flex><span>2022-03-29 11:26:40 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Apply started.
</span></span><span style=display:flex><span>2022-03-29 11:26:40 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Using dir &lt;.devstream&gt; to store plugins.
</span></span><span style=display:flex><span>2022-03-29 11:26:40 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Tool my-file <span style=color:#ce5c00;font-weight:700>(</span>localfile<span style=color:#ce5c00;font-weight:700>)</span> drifted from the state, will be updated.
</span></span><span style=display:flex><span>2022-03-29 11:26:40 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Start executing the plan.
</span></span><span style=display:flex><span>2022-03-29 11:26:40 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Changes count: 1.
</span></span><span style=display:flex><span>2022-03-29 11:26:40 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  -------------------- <span style=color:#ce5c00;font-weight:700>[</span>  Processing progress: 1/1.  <span style=color:#ce5c00;font-weight:700>]</span> --------------------
</span></span><span style=display:flex><span>2022-03-29 11:26:40 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Processing: my-file <span style=color:#ce5c00;font-weight:700>(</span>localfile<span style=color:#ce5c00;font-weight:700>)</span> -&gt; Update ...
</span></span><span style=display:flex><span>2022-03-29 11:26:40 ✔ <span style=color:#ce5c00;font-weight:700>[</span>SUCCESS<span style=color:#ce5c00;font-weight:700>]</span>  Plugin my-file<span style=color:#ce5c00;font-weight:700>(</span>localfile<span style=color:#ce5c00;font-weight:700>)</span> Update <span style=color:#204a87;font-weight:700>done</span>.
</span></span><span style=display:flex><span>2022-03-29 11:26:40 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  -------------------- <span style=color:#ce5c00;font-weight:700>[</span>  Processing <span style=color:#204a87;font-weight:700>done</span>.  <span style=color:#ce5c00;font-weight:700>]</span> --------------------
</span></span><span style=display:flex><span>2022-03-29 11:26:40 ✔ <span style=color:#ce5c00;font-weight:700>[</span>SUCCESS<span style=color:#ce5c00;font-weight:700>]</span>  All plugins applied successfully.
</span></span><span style=display:flex><span>2022-03-29 11:26:40 ✔ <span style=color:#ce5c00;font-weight:700>[</span>SUCCESS<span style=color:#ce5c00;font-weight:700>]</span>  Apply finished.
</span></span></code></pre></div><p>We can see that the file has drifted from the state, so it will be updated. After the operation, the file&rsquo;s content is changed back to what we defined in our config.</p><p>Heck, let&rsquo;s even try deleting this file and see what happens:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ rm foo.txt
</span></span><span style=display:flex><span>$ ./dtm -y apply -f config-localfile-test.yaml
</span></span><span style=display:flex><span>2022-03-29 11:27:33 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Apply started.
</span></span><span style=display:flex><span>2022-03-29 11:27:33 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Using dir &lt;.devstream&gt; to store plugins.
</span></span><span style=display:flex><span>2022-03-29 11:27:33 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Tool my-file <span style=color:#ce5c00;font-weight:700>(</span>localfile<span style=color:#ce5c00;font-weight:700>)</span> state found but it seems the tool isn<span style=color:#a40000>&#39;</span>t created, will be created.
</span></span><span style=display:flex><span>2022-03-29 11:27:33 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Start executing the plan.
</span></span><span style=display:flex><span>2022-03-29 11:27:33 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Changes count: 1.
</span></span><span style=display:flex><span>2022-03-29 11:27:33 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  -------------------- <span style=color:#ce5c00;font-weight:700>[</span>  Processing progress: 1/1.  <span style=color:#ce5c00;font-weight:700>]</span> --------------------
</span></span><span style=display:flex><span>2022-03-29 11:27:33 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Processing: my-file <span style=color:#ce5c00;font-weight:700>(</span>localfile<span style=color:#ce5c00;font-weight:700>)</span> -&gt; Create ...
</span></span><span style=display:flex><span>2022-03-29 11:27:33 ✔ <span style=color:#ce5c00;font-weight:700>[</span>SUCCESS<span style=color:#ce5c00;font-weight:700>]</span>  Plugin my-file<span style=color:#ce5c00;font-weight:700>(</span>localfile<span style=color:#ce5c00;font-weight:700>)</span> Create <span style=color:#204a87;font-weight:700>done</span>.
</span></span><span style=display:flex><span>2022-03-29 11:27:33 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  -------------------- <span style=color:#ce5c00;font-weight:700>[</span>  Processing <span style=color:#204a87;font-weight:700>done</span>.  <span style=color:#ce5c00;font-weight:700>]</span> --------------------
</span></span><span style=display:flex><span>2022-03-29 11:27:33 ✔ <span style=color:#ce5c00;font-weight:700>[</span>SUCCESS<span style=color:#ce5c00;font-weight:700>]</span>  All plugins applied successfully.
</span></span><span style=display:flex><span>2022-03-29 11:27:33 ✔ <span style=color:#ce5c00;font-weight:700>[</span>SUCCESS<span style=color:#ce5c00;font-weight:700>]</span>  Apply finished.
</span></span></code></pre></div><p>Apparently, DevStream thought the file should exist according to the state, but it doesn&rsquo;t, so it is created again.</p><p>Last, let&rsquo;s try to <code>delete</code> this file with <code>dtm</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ./dtm -y delete -f config-localfile-test.yaml
</span></span><span style=display:flex><span>2022-03-29 11:32:24 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Delete started.
</span></span><span style=display:flex><span>2022-03-29 11:32:24 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Using dir &lt;.devstream&gt; to store plugins.
</span></span><span style=display:flex><span>2022-03-29 11:32:24 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Tool my-file <span style=color:#ce5c00;font-weight:700>(</span>localfile<span style=color:#ce5c00;font-weight:700>)</span> will be deleted.
</span></span><span style=display:flex><span>2022-03-29 11:32:24 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Start executing the plan.
</span></span><span style=display:flex><span>2022-03-29 11:32:24 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Changes count: 1.
</span></span><span style=display:flex><span>2022-03-29 11:32:24 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  -------------------- <span style=color:#ce5c00;font-weight:700>[</span>  Processing progress: 1/1.  <span style=color:#ce5c00;font-weight:700>]</span> --------------------
</span></span><span style=display:flex><span>2022-03-29 11:32:24 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Processing: my-file <span style=color:#ce5c00;font-weight:700>(</span>localfile<span style=color:#ce5c00;font-weight:700>)</span> -&gt; Delete ...
</span></span><span style=display:flex><span>2022-03-29 11:32:24 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  Prepare to delete <span style=color:#4e9a06>&#39;my-file_localfile&#39;</span> from States.
</span></span><span style=display:flex><span>2022-03-29 11:32:24 ✔ <span style=color:#ce5c00;font-weight:700>[</span>SUCCESS<span style=color:#ce5c00;font-weight:700>]</span>  Plugin my-file <span style=color:#ce5c00;font-weight:700>(</span>localfile<span style=color:#ce5c00;font-weight:700>)</span> delete <span style=color:#204a87;font-weight:700>done</span>.
</span></span><span style=display:flex><span>2022-03-29 11:32:24 ℹ <span style=color:#ce5c00;font-weight:700>[</span>INFO<span style=color:#ce5c00;font-weight:700>]</span>  -------------------- <span style=color:#ce5c00;font-weight:700>[</span>  Processing <span style=color:#204a87;font-weight:700>done</span>.  <span style=color:#ce5c00;font-weight:700>]</span> --------------------
</span></span><span style=display:flex><span>2022-03-29 11:32:24 ✔ <span style=color:#ce5c00;font-weight:700>[</span>SUCCESS<span style=color:#ce5c00;font-weight:700>]</span>  All plugins deleted successfully.
</span></span><span style=display:flex><span>2022-03-29 11:32:24 ✔ <span style=color:#ce5c00;font-weight:700>[</span>SUCCESS<span style=color:#ce5c00;font-weight:700>]</span>  Delete finished.
</span></span></code></pre></div><p>Hooray!</p><h2 id=summary>Summary</h2><p>I&rsquo;m sorry that I put the &ldquo;TL;DR&rdquo; at the end; it&rsquo;s only because I want you to have a global feeling of DevStream. But for advanced developers, here&rsquo;s a &ldquo;TL;DR&rdquo; (or use it as a checklist) for you:</p><ul><li>Run <code>dtm develop create-plugin --name=your-plugin</code>.</li><li>Do a <code>git status</code>, then:<ul><li>find the generated files</li><li>edit/code at the places where there is already a comment mark</li></ul></li><li>Pay special attention to the return value of the interfaces. Figure out the relationship between <em>State</em> and <em>Resource</em>. What the interfaces return decides how this plugin will behave.</li><li>Last but not least, update the documentation.</li></ul><p>If you enjoy reading this post, please like, comment, and subscribe! I will see you next time.</p><ul class="list-unstyled d-flex justify-content-between align-items-center mb-0 pt-5"><li><a href=/blog/hello-world/ aria-label="Previous - Hello, World" class="btn btn-primary"><span class=mr-1>←</span>Previous</a></li><a class="btn btn-primary disabled">Next<span class=ml-1>→</span></a></li></ul></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank rel=noopener href=https://example.org/mail aria-label="User mailing list"><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://example.org/twitter aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank rel=noopener href=https://example.org/stack aria-label="Stack Overflow"><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/devstream-io/devstream aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel=noopener href=https://example.org/slack aria-label=Slack><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Developer mailing list" aria-label="Developer mailing list"><a class=text-white target=_blank rel=noopener href=https://example.org/mail aria-label="Developer mailing list"><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2022 DevStream Community All Rights Reserved</small>
<small class=ml-1><a href=https://xxx target=_blank rel=noopener>Privacy Policy</a></small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.7aa764d41598f3ae2d75328dec2bf5fa47be3f2e92011bb6b24b25ba3eabca52.js integrity="sha256-eqdk1BWY864tdTKN7Cv1+ke+Py6SARu2sksluj6rylI=" crossorigin=anonymous></script></body></html>